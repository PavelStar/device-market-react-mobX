{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Pavel/Desktop/js/device-market-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Users/Pavel/Desktop/js/device-market-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useRef,useState}from\"react\";import{observer}from\"mobx-react-lite\";import ItemCard from\"../../components/ItemCard/ItemCard\";import ResponseDataState from\"../../store/ResponseDataState\";import FiltersSettingsState from\"../../store/FiltersSettingsState\";import ApiService from\"../../API/ApiService\";import SortingBySelect from\"../../components/SortingBySelect/SortingSelect\";import SortingByState from\"../../store/SortingByState\";import{SetFilterSettings}from\"../../Utils/SetFilterSettings\";import{setSortByItems}from\"../../Utils/setSortByItems\";import CatalogIcon from\"../../components/svg/CatalogIcon\";import CatalogPageLoader from\"../../components/Loaders/CatalogPageLoaders/CatalogPageLoader\";import ClearFiltersBtn from\"../../components/buttons/ResetFiltersBtn/ResetFiltersBtn\";import FiltersPanel from\"../../components/FiltersPanel/FiltersPanel\";import\"./CatalogPage.scss\";import PageWidthState from\"../../store/PageWidthState\";import Pagination from\"../../components/Pagination/Pagination\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CatalogPage=observer(function(){var apiService=new ApiService();var selectedCategories=FiltersSettingsState.selectedCategories,selectedBrands=FiltersSettingsState.selectedBrands,priceRange=FiltersSettingsState.priceRange,isAvailable=FiltersSettingsState.isAvailable,isDiscount=FiltersSettingsState.isDiscount;var sortingByType=SortingByState.sortingByType;var responseData=ResponseDataState.responseData;var isMobile=PageWidthState.isMobile;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),itemsToShow=_useState2[0],setItemsToShow=_useState2[1];var _useState3=useState(6),_useState4=_slicedToArray(_useState3,2),itemsPerPage=_useState4[0],setItemsPerPage=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),startIndex=_useState6[0],setStartIndex=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),isLoading=_useState8[0],setIsLoading=_useState8[1];var filtersWrapRef=useRef(null);useEffect(function(){apiService.getData().then(function(data){ResponseDataState.setResponseData(data);setItemsToShow(SetFilterSettings());});},[]);useEffect(function(){if(itemsToShow){setIsLoading(true);setItemsToShow(SetFilterSettings());setIsLoading(false);}},[selectedCategories,selectedBrands,priceRange,isAvailable,isDiscount]);useEffect(function(){if(itemsToShow){setItemsToShow(setSortByItems(_toConsumableArray(itemsToShow)));window.scrollTo(0,0);}},[sortingByType]);var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isFiltersPanelShown=_useState10[0],setIsFiltersPanelShown=_useState10[1];var showFilters=function showFilters(){setIsFiltersPanelShown(!isFiltersPanelShown);console.log('first');};// useEffect(() => {\n//     setIsFiltersPanelShown(!isFiltersPanelShown);\n// }, [isMobile])\nreturn/*#__PURE__*/_jsx(_Fragment,{children:isLoading?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(CatalogPageLoader,{})}):/*#__PURE__*/_jsxs(\"div\",{className:\"catalog-page\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"catalog-page__title section-title\",children:[\"\\u0422\\u043E\\u0432\\u0430\\u0440\\u043E\\u0432 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u043E (\",itemsToShow&&itemsToShow.length,\")\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"catalog-page__inner\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"catalog-page__filters-wrap\",ref:filtersWrapRef,children:!isMobile||isFiltersPanelShown?/*#__PURE__*/_jsx(FiltersPanel,{itemsToShowCount:itemsToShow.length,showFilters:showFilters}):null}),/*#__PURE__*/_jsxs(\"div\",{className:\"catalog-page__items-wrap\",children:[(itemsToShow===null||itemsToShow===void 0?void 0:itemsToShow.length)>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Pagination,{itemsCount:itemsToShow.length,itemsPerPage:itemsPerPage,startIndex:startIndex,setStartIndex:setStartIndex}),/*#__PURE__*/_jsxs(\"div\",{className:\"catalog-page__mobile-settings\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"catalog-page__btn-show-filters\",onClick:showFilters,children:[/*#__PURE__*/_jsx(CatalogIcon,{}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0424\\u0438\\u043B\\u044C\\u0442\\u0440\\u044B\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"catalog-page__sorting-by-wrap\",children:/*#__PURE__*/_jsx(SortingBySelect,{itemsToShow:itemsToShow,setItemsToShow:setItemsToShow})})]}),/*#__PURE__*/_jsx(\"ul\",{className:\"catalog-page__results-list results-list\",children:itemsToShow.slice(startIndex,startIndex+itemsPerPage).map(function(item){return/*#__PURE__*/_jsx(ItemCard,{inPageView:\"inPage\",item:item});})})]}),(itemsToShow===null||itemsToShow===void 0?void 0:itemsToShow.length)===0&&responseData&&/*#__PURE__*/_jsxs(\"div\",{className:\"catalog-page__results-not-found\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u041F\\u043E \\u0434\\u0430\\u043D\\u043D\\u044B\\u043C \\u043F\\u0430\\u0440\\u0430\\u043C\\u0435\\u0442\\u0440\\u0430\\u043C \\u043D\\u0438\\u0447\\u0435\\u0433\\u043E \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u043E\"}),/*#__PURE__*/_jsx(ClearFiltersBtn,{})]})]})]})]})});});export default CatalogPage;","map":{"version":3,"sources":["C:/Users/Pavel/Desktop/js/device-market-master/client/src/pages/CatalogPage/CatalogPage.tsx"],"names":["useEffect","useRef","useState","observer","ItemCard","ResponseDataState","FiltersSettingsState","ApiService","SortingBySelect","SortingByState","SetFilterSettings","setSortByItems","CatalogIcon","CatalogPageLoader","ClearFiltersBtn","FiltersPanel","PageWidthState","Pagination","CatalogPage","apiService","selectedCategories","selectedBrands","priceRange","isAvailable","isDiscount","sortingByType","responseData","isMobile","itemsToShow","setItemsToShow","itemsPerPage","setItemsPerPage","startIndex","setStartIndex","isLoading","setIsLoading","filtersWrapRef","getData","then","data","setResponseData","window","scrollTo","isFiltersPanelShown","setIsFiltersPanelShown","showFilters","console","log","length","slice","map","item"],"mappings":"gWAAA,OAASA,SAAT,CAAoBC,MAApB,CAA4BC,QAA5B,KAA4C,OAA5C,CACA,OAASC,QAAT,KAAyB,iBAAzB,CAEA,MAAOC,CAAAA,QAAP,KAAqB,oCAArB,CACA,MAAOC,CAAAA,iBAAP,KAA8B,+BAA9B,CACA,MAAOC,CAAAA,oBAAP,KAAiC,kCAAjC,CACA,MAAOC,CAAAA,UAAP,KAAuB,sBAAvB,CACA,MAAOC,CAAAA,eAAP,KAA4B,gDAA5B,CACA,MAAOC,CAAAA,cAAP,KAA2B,4BAA3B,CACA,OAASC,iBAAT,KAAkC,+BAAlC,CACA,OAASC,cAAT,KAA+B,4BAA/B,CACA,MAAOC,CAAAA,WAAP,KAAwB,kCAAxB,CACA,MAAOC,CAAAA,iBAAP,KAA8B,+DAA9B,CACA,MAAOC,CAAAA,eAAP,KAA4B,0DAA5B,CACA,MAAOC,CAAAA,YAAP,KAAyB,4CAAzB,CACA,MAAO,oBAAP,CACA,MAAOC,CAAAA,cAAP,KAA2B,4BAA3B,CACA,MAAOC,CAAAA,UAAP,KAAuB,wCAAvB,C,6IAEA,GAAMC,CAAAA,WAAW,CAAGf,QAAQ,CAAC,UAAM,CAC/B,GAAMgB,CAAAA,UAAU,CAAG,GAAIZ,CAAAA,UAAJ,EAAnB,CAEA,GAAQa,CAAAA,kBAAR,CAAoFd,oBAApF,CAAQc,kBAAR,CAA4BC,cAA5B,CAAoFf,oBAApF,CAA4Be,cAA5B,CAA4CC,UAA5C,CAAoFhB,oBAApF,CAA4CgB,UAA5C,CAAwDC,WAAxD,CAAoFjB,oBAApF,CAAwDiB,WAAxD,CAAqEC,UAArE,CAAoFlB,oBAApF,CAAqEkB,UAArE,CACA,GAAQC,CAAAA,aAAR,CAA0BhB,cAA1B,CAAQgB,aAAR,CACA,GAAQC,CAAAA,YAAR,CAAyBrB,iBAAzB,CAAQqB,YAAR,CACA,GAAQC,CAAAA,QAAR,CAAqBX,cAArB,CAAQW,QAAR,CAEA,cAAsCzB,QAAQ,CAAC,EAAD,CAA9C,wCAAO0B,WAAP,eAAoBC,cAApB,eACA,eAAwC3B,QAAQ,CAAS,CAAT,CAAhD,yCAAO4B,YAAP,eAAqBC,eAArB,eACA,eAAoC7B,QAAQ,CAAS,CAAT,CAA5C,yCAAO8B,UAAP,eAAmBC,aAAnB,eACA,eAAkC/B,QAAQ,CAAC,IAAD,CAA1C,yCAAOgC,SAAP,eAAkBC,YAAlB,eAEA,GAAMC,CAAAA,cAAc,CAAGnC,MAAM,CAAC,IAAD,CAA7B,CAKAD,SAAS,CAAC,UAAM,CACZmB,UAAU,CAACkB,OAAX,GAAqBC,IAArB,CAA0B,SAACC,IAAD,CAAU,CAChClC,iBAAiB,CAACmC,eAAlB,CAAkCD,IAAlC,EACAV,cAAc,CAACnB,iBAAiB,EAAlB,CAAd,CACH,CAHD,EAIH,CALQ,CAKN,EALM,CAAT,CAOAV,SAAS,CAAC,UAAM,CACZ,GAAI4B,WAAJ,CAAiB,CACbO,YAAY,CAAC,IAAD,CAAZ,CACAN,cAAc,CAACnB,iBAAiB,EAAlB,CAAd,CACAyB,YAAY,CAAC,KAAD,CAAZ,CACH,CACJ,CANQ,CAMN,CAACf,kBAAD,CAAqBC,cAArB,CAAqCC,UAArC,CAAiDC,WAAjD,CAA8DC,UAA9D,CANM,CAAT,CAQAxB,SAAS,CAAC,UAAM,CACZ,GAAI4B,WAAJ,CAAiB,CACbC,cAAc,CAAClB,cAAc,oBAAKiB,WAAL,EAAf,CAAd,CACAa,MAAM,CAACC,QAAP,CAAgB,CAAhB,CAAmB,CAAnB,EACH,CACJ,CALQ,CAKN,CAACjB,aAAD,CALM,CAAT,CAOA,eAAsDvB,QAAQ,CAAC,KAAD,CAA9D,0CAAOyC,mBAAP,gBAA4BC,sBAA5B,gBAEA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CACtBD,sBAAsB,CAAC,CAACD,mBAAF,CAAtB,CACAG,OAAO,CAACC,GAAR,CAAY,OAAZ,EACH,CAHD,CAKA;AACA;AACA;AAEA,mBACI,yBACKb,SAAS,cACN,sCACI,KAAC,iBAAD,IADJ,EADM,cAKN,aAAK,SAAS,CAAC,cAAf,wBACI,YAAI,SAAS,CAAC,mCAAd,qGACsBN,WAAW,EAAIA,WAAW,CAACoB,MADjD,OADJ,cAII,aAAK,SAAS,CAAC,qBAAf,wBACI,YAAK,SAAS,CAAC,4BAAf,CAA4C,GAAG,CAAEZ,cAAjD,UACK,CAACT,QAAD,EAAagB,mBAAb,cACG,KAAC,YAAD,EAAc,gBAAgB,CAAEf,WAAW,CAACoB,MAA5C,CAAoD,WAAW,CAAEH,WAAjE,EADH,CAEG,IAHR,EADJ,cAOI,aAAK,SAAS,CAAC,0BAAf,WACK,CAAAjB,WAAW,OAAX,EAAAA,WAAW,SAAX,QAAAA,WAAW,CAAEoB,MAAb,EAAsB,CAAtB,eACG,wCACI,KAAC,UAAD,EACI,UAAU,CAAEpB,WAAW,CAACoB,MAD5B,CAEI,YAAY,CAAElB,YAFlB,CAGI,UAAU,CAAEE,UAHhB,CAII,aAAa,CAAEC,aAJnB,EADJ,cAOI,aAAK,SAAS,CAAC,+BAAf,wBACI,gBAAQ,SAAS,CAAC,gCAAlB,CAAmD,OAAO,CAAEY,WAA5D,wBACI,KAAC,WAAD,IADJ,cAEI,oEAFJ,GADJ,cAKI,YAAK,SAAS,CAAC,+BAAf,uBACI,KAAC,eAAD,EACI,WAAW,CAAEjB,WADjB,CAEI,cAAc,CAAEC,cAFpB,EADJ,EALJ,GAPJ,cAmBI,WAAI,SAAS,CAAC,yCAAd,UACKD,WAAW,CACPqB,KADJ,CACUjB,UADV,CACsBA,UAAU,CAAGF,YADnC,EAEIoB,GAFJ,CAEQ,SAACC,IAAD,CAAqB,CACtB,mBAAO,KAAC,QAAD,EAAU,UAAU,CAAC,QAArB,CAA8B,IAAI,CAAEA,IAApC,EAAP,CACH,CAJJ,CADL,EAnBJ,GAFR,CAiCK,CAAAvB,WAAW,OAAX,EAAAA,WAAW,SAAX,QAAAA,WAAW,CAAEoB,MAAb,IAAwB,CAAxB,EAA6BtB,YAA7B,eACG,aAAK,SAAS,CAAC,iCAAf,wBACI,kOADJ,cAEI,KAAC,eAAD,IAFJ,GAlCR,GAPJ,GAJJ,GANR,EADJ,CA+DH,CAlH2B,CAA5B,CAoHA,cAAeR,CAAAA,WAAf","sourcesContent":["import { useEffect, useRef, useState } from \"react\";\nimport { observer } from \"mobx-react-lite\";\nimport { IItemData } from \"../../interfaces/IItemData\";\nimport ItemCard from \"../../components/ItemCard/ItemCard\";\nimport ResponseDataState from \"../../store/ResponseDataState\";\nimport FiltersSettingsState from \"../../store/FiltersSettingsState\";\nimport ApiService from \"../../API/ApiService\";\nimport SortingBySelect from \"../../components/SortingBySelect/SortingSelect\";\nimport SortingByState from \"../../store/SortingByState\";\nimport { SetFilterSettings } from \"../../Utils/SetFilterSettings\";\nimport { setSortByItems } from \"../../Utils/setSortByItems\";\nimport CatalogIcon from \"../../components/svg/CatalogIcon\";\nimport CatalogPageLoader from \"../../components/Loaders/CatalogPageLoaders/CatalogPageLoader\";\nimport ClearFiltersBtn from \"../../components/buttons/ResetFiltersBtn/ResetFiltersBtn\";\nimport FiltersPanel from \"../../components/FiltersPanel/FiltersPanel\";\nimport \"./CatalogPage.scss\";\nimport PageWidthState from \"../../store/PageWidthState\";\nimport Pagination from \"../../components/Pagination/Pagination\";\n\nconst CatalogPage = observer(() => {\n    const apiService = new ApiService();\n\n    const { selectedCategories, selectedBrands, priceRange, isAvailable, isDiscount } = FiltersSettingsState;\n    const { sortingByType } = SortingByState;\n    const { responseData } = ResponseDataState;\n    const { isMobile } = PageWidthState;\n\n    const [itemsToShow, setItemsToShow] = useState([]);\n    const [itemsPerPage, setItemsPerPage] = useState<number>(6);\n    const [startIndex, setStartIndex] = useState<number>(0);\n    const [isLoading, setIsLoading] = useState(true);\n\n    const filtersWrapRef = useRef(null);\n\n\n\n\n    useEffect(() => {\n        apiService.getData().then((data) => {\n            ResponseDataState.setResponseData(data);\n            setItemsToShow(SetFilterSettings());\n        });\n    }, []);\n\n    useEffect(() => {\n        if (itemsToShow) {\n            setIsLoading(true);\n            setItemsToShow(SetFilterSettings());\n            setIsLoading(false);\n        }\n    }, [selectedCategories, selectedBrands, priceRange, isAvailable, isDiscount]);\n\n    useEffect(() => {\n        if (itemsToShow) {\n            setItemsToShow(setSortByItems([...itemsToShow]));\n            window.scrollTo(0, 0);\n        }\n    }, [sortingByType]);\n\n    const [isFiltersPanelShown, setIsFiltersPanelShown] = useState(false);\n\n    const showFilters = () => {\n        setIsFiltersPanelShown(!isFiltersPanelShown);\n        console.log('first')\n    };\n\n    // useEffect(() => {\n    //     setIsFiltersPanelShown(!isFiltersPanelShown);\n    // }, [isMobile])\n\n    return (\n        <>\n            {isLoading ? (\n                <>\n                    <CatalogPageLoader />\n                </>\n            ) : (\n                <div className=\"catalog-page\">\n                    <h1 className=\"catalog-page__title section-title\">\n                        Товаров найдено ({itemsToShow && itemsToShow.length})\n                    </h1>\n                    <div className=\"catalog-page__inner\">\n                        <div className=\"catalog-page__filters-wrap\" ref={filtersWrapRef}>\n                            {!isMobile || isFiltersPanelShown ? (\n                                <FiltersPanel itemsToShowCount={itemsToShow.length} showFilters={showFilters} />\n                            ) : null}\n                        </div>\n\n                        <div className=\"catalog-page__items-wrap\">\n                            {itemsToShow?.length > 0 && (\n                                <>\n                                    <Pagination\n                                        itemsCount={itemsToShow.length}\n                                        itemsPerPage={itemsPerPage}\n                                        startIndex={startIndex}\n                                        setStartIndex={setStartIndex}\n                                    />\n                                    <div className=\"catalog-page__mobile-settings\">\n                                        <button className=\"catalog-page__btn-show-filters\" onClick={showFilters}>\n                                            <CatalogIcon />\n                                            <span>Фильтры</span>\n                                        </button>\n                                        <div className=\"catalog-page__sorting-by-wrap\">\n                                            <SortingBySelect\n                                                itemsToShow={itemsToShow}\n                                                setItemsToShow={setItemsToShow}\n                                            />\n                                        </div>\n                                    </div>\n                                    <ul className=\"catalog-page__results-list results-list\">\n                                        {itemsToShow\n                                            .slice(startIndex, startIndex + itemsPerPage)\n                                            .map((item: IItemData) => {\n                                                return <ItemCard inPageView=\"inPage\" item={item} />;\n                                            })}\n                                        {/* {itemsToShow.map((item: IItemData) => {\n                                            return <ItemCard inPageView=\"inPage\" item={item} />;\n                                        })} */}\n                                    </ul>\n                                </>\n                            )}\n                            {itemsToShow?.length === 0 && responseData && (\n                                <div className=\"catalog-page__results-not-found\">\n                                    <p>По данным параметрам ничего не найдено</p>\n                                    <ClearFiltersBtn />\n                                </div>\n                            )}\n                        </div>\n                    </div>\n                </div>\n            )}\n        </>\n    );\n});\n\nexport default CatalogPage;\n"]},"metadata":{},"sourceType":"module"}
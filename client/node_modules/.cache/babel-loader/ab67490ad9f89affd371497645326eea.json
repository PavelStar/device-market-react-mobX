{"ast":null,"code":"import React,{useEffect,useRef}from\"react\";import{Link}from\"react-router-dom\";import ItemDataState from\"../../../store/ItemDataState\";import SearchState from\"../../../store/SearchState\";import ResponseDataState from\"../../../store/ResponseDataState\";import{observer}from\"mobx-react-lite\";import PageWidthState from\"../../../store/PageWidthState\";import\"./SearchResultsList.scss\";import{clearAllBodyScrollLocks}from\"body-scroll-lock\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SearchResultsList=observer(function(_ref){var resultsHeight=_ref.resultsHeight,searchInnerRef=_ref.searchInnerRef;var searchResultsRef=useRef(null);var responseData=ResponseDataState.responseData;var searchInputValue=SearchState.searchInputValue,searchResults=SearchState.searchResults,isResultsShown=SearchState.isResultsShown,isFocused=SearchState.isFocused;var isMobile=PageWidthState.isMobile;useEffect(function(){document.addEventListener(\"click\",outsideSearchClick);return function(){document.removeEventListener(\"click\",outsideSearchClick);};},[]);useEffect(function(){if(responseData){SearchState.setSearchResults(responseData.items.filter(function(item){return item.title.toLocaleLowerCase().includes(searchInputValue.toLocaleLowerCase())||item.brand.toLocaleLowerCase().includes(searchInputValue.toLocaleLowerCase());}));}},[searchInputValue]);var outsideSearchClick=function outsideSearchClick(e){var _searchInnerRef$curre;if(!((_searchInnerRef$curre=searchInnerRef.current)===null||_searchInnerRef$curre===void 0?void 0:_searchInnerRef$curre.contains(e.target))){SearchState.setIsResultsShown(false);}};var onResultClick=function onResultClick(item){ItemDataState.setItemData(item);SearchState.setIsResultsShown(false);SearchState.setIsSearchShown(false);SearchState.setSearchInputValue('');clearAllBodyScrollLocks();};return/*#__PURE__*/_jsxs(\"ul\",{className:\"search__results-list search-results\",ref:searchResultsRef,children:[searchInputValue&&searchResults.map(function(item){var color=item.color,title=item.title,_item$priceInfo=item.priceInfo,fullPrice=_item$priceInfo.fullPrice,discountAmount=_item$priceInfo.discountAmount,snippetImage=item.images.snippetImage,memory=item.features.memory;return/*#__PURE__*/_jsx(\"li\",{className:\"search-results__item\",children:/*#__PURE__*/_jsxs(Link,{to:\"/item\",className:\"search-results__link\",onClick:function onClick(){return onResultClick(item);},children:[/*#__PURE__*/_jsx(\"div\",{className:\"search-results__img-wrap\",children:/*#__PURE__*/_jsx(\"img\",{className:\"search-results__img\",src:snippetImage,alt:title,height:\"50\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-results__text-wrap\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"search-results__title\",children:[title,\", \",color,\", \",memory]}),/*#__PURE__*/_jsxs(\"p\",{className:\"search-results__price\",children:[fullPrice-discountAmount,\" \\u0440.\"]})]})]})},item.id);}),searchInputValue&&!searchResults.length&&/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u041F\\u043E \\u0437\\u0430\\u043F\\u0440\\u043E\\u0441\\u0443 \",/*#__PURE__*/_jsxs(\"span\",{className:\"search-results__results-not-found\",children:[searchInputValue,\" \"]}),\"\\u043D\\u0438\\u0447\\u0435\\u0433\\u043E \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u043E\"]})]});});export default SearchResultsList;","map":{"version":3,"sources":["C:/Users/Pavel/Desktop/js/device-market-master/client/src/components/SearchBar/SearchResultsList/SearchResultsList.tsx"],"names":["React","useEffect","useRef","Link","ItemDataState","SearchState","ResponseDataState","observer","PageWidthState","clearAllBodyScrollLocks","SearchResultsList","resultsHeight","searchInnerRef","searchResultsRef","responseData","searchInputValue","searchResults","isResultsShown","isFocused","isMobile","document","addEventListener","outsideSearchClick","removeEventListener","setSearchResults","items","filter","item","title","toLocaleLowerCase","includes","brand","e","current","contains","target","setIsResultsShown","onResultClick","setItemData","setIsSearchShown","setSearchInputValue","map","color","priceInfo","fullPrice","discountAmount","snippetImage","images","memory","features","id","length"],"mappings":"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","sourcesContent":["import React, { RefObject, useEffect, useRef } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { IItemData } from \"../../../interfaces/IItemData\";\r\nimport ItemDataState from \"../../../store/ItemDataState\";\r\nimport SearchState from \"../../../store/SearchState\";\r\nimport ToItemLink from \"../../buttons/ToItemLink/ToItemLink\";\r\nimport ResponseDataState from \"../../../store/ResponseDataState\";\r\nimport { observer } from \"mobx-react-lite\";\r\nimport PageWidthState from \"../../../store/PageWidthState\";\r\nimport \"./SearchResultsList.scss\";\r\nimport { clearAllBodyScrollLocks } from \"body-scroll-lock\";\r\n\r\nconst SearchResultsList = observer(\r\n    ({ resultsHeight, searchInnerRef }: { resultsHeight?: number; searchInnerRef: RefObject<HTMLDivElement> }) => {\r\n        const searchResultsRef = useRef<HTMLUListElement>(null);\r\n\r\n        const { responseData } = ResponseDataState;\r\n        const { searchInputValue, searchResults, isResultsShown, isFocused } = SearchState;\r\n        const { isMobile } = PageWidthState;\r\n\r\n\r\n\r\n        useEffect(() => {\r\n            document.addEventListener(\"click\", outsideSearchClick);\r\n\r\n            return () => {\r\n                document.removeEventListener(\"click\", outsideSearchClick);\r\n            };\r\n        }, []);\r\n\r\n        useEffect(() => {\r\n            if (responseData) {\r\n                SearchState.setSearchResults(\r\n                    responseData.items.filter((item) => {\r\n                        return (\r\n                            item.title.toLocaleLowerCase().includes(searchInputValue.toLocaleLowerCase()) ||\r\n                            item.brand.toLocaleLowerCase().includes(searchInputValue.toLocaleLowerCase())\r\n                        );\r\n                    })\r\n                );\r\n            }\r\n        }, [searchInputValue]);\r\n\r\n        const outsideSearchClick = (e: any) => {\r\n            if (!searchInnerRef.current?.contains(e.target as Node)) {\r\n                SearchState.setIsResultsShown(false);\r\n            }\r\n        };\r\n\r\n        const onResultClick = (item: IItemData) => {\r\n            ItemDataState.setItemData(item);\r\n            SearchState.setIsResultsShown(false);\r\n            SearchState.setIsSearchShown(false)\r\n            SearchState.setSearchInputValue('')\r\n            clearAllBodyScrollLocks()\r\n        };\r\n\r\n        return (\r\n            <ul className=\"search__results-list search-results\" ref={searchResultsRef}>\r\n                {searchInputValue &&\r\n                    searchResults.map((item: IItemData) => {\r\n                        const {\r\n                            color,\r\n                            title,\r\n                            priceInfo: { fullPrice, discountAmount },\r\n                            images: { snippetImage },\r\n                            features: { memory },\r\n                        } = item;\r\n\r\n                        return (\r\n                            <li key={item.id} className=\"search-results__item\">\r\n                                <Link to=\"/item\" className=\"search-results__link\" onClick={() => onResultClick(item)}>\r\n                                    <div className=\"search-results__img-wrap\">\r\n                                        <img\r\n                                            className=\"search-results__img\"\r\n                                            src={snippetImage}\r\n                                            alt={title}\r\n                                            height=\"50\"\r\n                                        />\r\n                                    </div>\r\n                                    <div className=\"search-results__text-wrap\">\r\n                                        <p className=\"search-results__title\">\r\n                                            {title}, {color}, {memory}\r\n                                        </p>\r\n                                        <p className=\"search-results__price\">{fullPrice - discountAmount} р.</p>\r\n                                    </div>\r\n                                </Link>\r\n                            </li>\r\n                        );\r\n                    })}\r\n                {searchInputValue && !searchResults.length && (\r\n                    <p>\r\n                        По запросу <span className=\"search-results__results-not-found\">{searchInputValue} </span>\r\n                        ничего не найдено\r\n                    </p>\r\n                )}\r\n            </ul>\r\n        );\r\n    }\r\n);\r\n\r\nexport default SearchResultsList;\r\n"]},"metadata":{},"sourceType":"module"}
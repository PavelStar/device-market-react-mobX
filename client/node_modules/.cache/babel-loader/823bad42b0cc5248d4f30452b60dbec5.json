{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Pavel\\\\Desktop\\\\js\\\\device-market-master\\\\client\\\\src\\\\components\\\\SearchBar\\\\SearchResultsList\\\\SearchResultsList.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useRef } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport SearchState from \"../../../store/SearchState\";\nimport ResponseDataState from \"../../../store/ResponseDataState\";\nimport { observer } from \"mobx-react-lite\";\nimport PageWidthState from \"../../../store/PageWidthState\";\nimport \"./SearchResultsList.scss\";\nimport { clearAllBodyScrollLocks } from \"body-scroll-lock\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SearchResultsList = observer(_c = _s(_ref => {\n  _s();\n\n  let {\n    resultsHeight,\n    searchInnerRef\n  } = _ref;\n  const searchResultsRef = useRef(null);\n  const {\n    responseData\n  } = ResponseDataState;\n  const {\n    searchInputValue,\n    searchResults,\n    isResultsShown,\n    isFocused\n  } = SearchState;\n  const {\n    isMobile\n  } = PageWidthState;\n  useEffect(() => {\n    document.addEventListener(\"click\", outsideSearchClick);\n    return () => {\n      document.removeEventListener(\"click\", outsideSearchClick);\n    };\n  }, []);\n  useEffect(() => {\n    if (responseData) {\n      SearchState.setSearchResults(responseData.items.filter(item => {\n        return item.title.toLocaleLowerCase().includes(searchInputValue.toLocaleLowerCase()) || item.brand.toLocaleLowerCase().includes(searchInputValue.toLocaleLowerCase());\n      }));\n    }\n  }, [searchInputValue]);\n\n  const outsideSearchClick = e => {\n    var _searchInnerRef$curre;\n\n    if (!((_searchInnerRef$curre = searchInnerRef.current) === null || _searchInnerRef$curre === void 0 ? void 0 : _searchInnerRef$curre.contains(e.target))) {\n      SearchState.setIsResultsShown(false);\n    }\n  };\n\n  const onResultClick = item => {\n    // ItemDataState.setItemData(item);\n    SearchState.setIsResultsShown(false);\n    SearchState.setIsSearchShown(false);\n    SearchState.setSearchInputValue('');\n    clearAllBodyScrollLocks();\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"ul\", {\n    className: \"search__results-list search-results\",\n    ref: searchResultsRef,\n    children: [searchInputValue && searchResults.map(item => {\n      const {\n        id,\n        color,\n        title,\n        priceInfo: {\n          fullPrice,\n          discountAmount\n        },\n        images: {\n          snippetImage\n        },\n        features: {\n          memory\n        }\n      } = item;\n      return /*#__PURE__*/_jsxDEV(\"li\", {\n        className: \"search-results__item\",\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          to: `/item/${id}`,\n          className: \"search-results__link\",\n          onClick: () => onResultClick(item),\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"search-results__img-wrap\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              className: \"search-results__img\",\n              src: snippetImage,\n              alt: title,\n              height: \"50\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 75,\n              columnNumber: 41\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 37\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"search-results__text-wrap\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"search-results__title\",\n              children: [title, \", \", color, \", \", memory]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 83,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"search-results__price\",\n              children: [fullPrice - discountAmount, \" \\u0440.\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 86,\n              columnNumber: 41\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 37\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 33\n        }, this)\n      }, item.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 29\n      }, this);\n    }), searchInputValue && !searchResults.length && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"\\u041F\\u043E \\u0437\\u0430\\u043F\\u0440\\u043E\\u0441\\u0443 \", /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"search-results__results-not-found\",\n        children: [searchInputValue, \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 36\n      }, this), \"\\u043D\\u0438\\u0447\\u0435\\u0433\\u043E \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u043E\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 21\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 13\n  }, this);\n}, \"dkjuBuX7cghGlSLvrQ0ggTC8qyY=\"));\n_c2 = SearchResultsList;\nexport default SearchResultsList;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"SearchResultsList$observer\");\n$RefreshReg$(_c2, \"SearchResultsList\");","map":{"version":3,"sources":["C:/Users/Pavel/Desktop/js/device-market-master/client/src/components/SearchBar/SearchResultsList/SearchResultsList.tsx"],"names":["React","useEffect","useRef","Link","SearchState","ResponseDataState","observer","PageWidthState","clearAllBodyScrollLocks","SearchResultsList","resultsHeight","searchInnerRef","searchResultsRef","responseData","searchInputValue","searchResults","isResultsShown","isFocused","isMobile","document","addEventListener","outsideSearchClick","removeEventListener","setSearchResults","items","filter","item","title","toLocaleLowerCase","includes","brand","e","current","contains","target","setIsResultsShown","onResultClick","setIsSearchShown","setSearchInputValue","map","id","color","priceInfo","fullPrice","discountAmount","images","snippetImage","features","memory","length"],"mappings":"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","sourcesContent":["import React, { RefObject, useEffect, useRef } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { IItemData } from \"../../../interfaces/IItemData\";\r\nimport ItemDataState from \"../../../store/ItemDataState\";\r\nimport SearchState from \"../../../store/SearchState\";\r\nimport ToItemLink from \"../../buttons/ToItemLink/ToItemLink\";\r\nimport ResponseDataState from \"../../../store/ResponseDataState\";\r\nimport { observer } from \"mobx-react-lite\";\r\nimport PageWidthState from \"../../../store/PageWidthState\";\r\nimport \"./SearchResultsList.scss\";\r\nimport { clearAllBodyScrollLocks } from \"body-scroll-lock\";\r\n\r\nconst SearchResultsList = observer(\r\n    ({ resultsHeight, searchInnerRef }: { resultsHeight?: number; searchInnerRef: RefObject<HTMLDivElement> }) => {\r\n        const searchResultsRef = useRef<HTMLUListElement>(null);\r\n\r\n        const { responseData } = ResponseDataState;\r\n        const { searchInputValue, searchResults, isResultsShown, isFocused } = SearchState;\r\n        const { isMobile } = PageWidthState;\r\n\r\n\r\n\r\n        useEffect(() => {\r\n            document.addEventListener(\"click\", outsideSearchClick);\r\n\r\n            return () => {\r\n                document.removeEventListener(\"click\", outsideSearchClick);\r\n            };\r\n        }, []);\r\n\r\n        useEffect(() => {\r\n            if (responseData) {\r\n                SearchState.setSearchResults(\r\n                    responseData.items.filter((item) => {\r\n                        return (\r\n                            item.title.toLocaleLowerCase().includes(searchInputValue.toLocaleLowerCase()) ||\r\n                            item.brand.toLocaleLowerCase().includes(searchInputValue.toLocaleLowerCase())\r\n                        );\r\n                    })\r\n                );\r\n            }\r\n        }, [searchInputValue]);\r\n\r\n        const outsideSearchClick = (e: any) => {\r\n            if (!searchInnerRef.current?.contains(e.target as Node)) {\r\n                SearchState.setIsResultsShown(false);\r\n            }\r\n        };\r\n\r\n        const onResultClick = (item: IItemData) => {\r\n            // ItemDataState.setItemData(item);\r\n            SearchState.setIsResultsShown(false);\r\n            SearchState.setIsSearchShown(false)\r\n            SearchState.setSearchInputValue('')\r\n            clearAllBodyScrollLocks()\r\n        };\r\n\r\n        return (\r\n            <ul className=\"search__results-list search-results\" ref={searchResultsRef}>\r\n                {searchInputValue &&\r\n                    searchResults.map((item: IItemData) => {\r\n                        const {\r\n                            id,\r\n                            color,\r\n                            title,\r\n                            priceInfo: { fullPrice, discountAmount },\r\n                            images: { snippetImage },\r\n                            features: { memory },\r\n                        } = item;\r\n\r\n                        return (\r\n                            <li key={item.id} className=\"search-results__item\">\r\n                                <Link to={`/item/${id}`} className=\"search-results__link\" onClick={() => onResultClick(item)}>\r\n                                    <div className=\"search-results__img-wrap\">\r\n                                        <img\r\n                                            className=\"search-results__img\"\r\n                                            src={snippetImage}\r\n                                            alt={title}\r\n                                            height=\"50\"\r\n                                        />\r\n                                    </div>\r\n                                    <div className=\"search-results__text-wrap\">\r\n                                        <p className=\"search-results__title\">\r\n                                            {title}, {color}, {memory}\r\n                                        </p>\r\n                                        <p className=\"search-results__price\">{fullPrice - discountAmount} р.</p>\r\n                                    </div>\r\n                                </Link>\r\n                            </li>\r\n                        );\r\n                    })}\r\n                {searchInputValue && !searchResults.length && (\r\n                    <p>\r\n                        По запросу <span className=\"search-results__results-not-found\">{searchInputValue} </span>\r\n                        ничего не найдено\r\n                    </p>\r\n                )}\r\n            </ul>\r\n        );\r\n    }\r\n);\r\n\r\nexport default SearchResultsList;\r\n"]},"metadata":{},"sourceType":"module"}